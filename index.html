<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ReMEDy2 Stroke Trial – Eligibility Checklist</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f7f9fc; color: #333; }
    h1, h2 { color: #003366; }
    .logo-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; }
    .logo-bar img { height: 70px; }
    .section { margin-bottom: 25px; }
    .radio-group { margin-bottom: 10px; }

    /* Question label */
    .radio-group label.question { font-weight: bold; display: block; margin-bottom: 5px; }

    /* Pill-style Yes/No choices */
    .choice {
      display: inline-flex;
      align-items: center;
      padding: 0.35rem 0.8rem;
      margin-right: 0.35rem;
      font-size: 0.8rem;
      border-radius: 0.25rem;
      cursor: pointer;
      user-select: none;
      transition: transform 0.1s, box-shadow 0.1s;
      border: 2px solid transparent;
      position: relative;
    }
    .choice input {
      position: absolute;
      opacity: 0;
      pointer-events: none;
    }
    .choice:hover { transform: translateY(-1px); box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    .choice:active { transform: translateY(0); box-shadow: 0 1px 2px rgba(0,0,0,0.1); }
    .choice.yes { background: #e6ffed; border-color: #28a745; color: #155724; }
    .choice.no  { background: #ffe6e6; border-color: #dc3545; color: #721c24; }
    .choice input:checked + span { outline: 3px solid rgba(0,0,0,0.15); }

    /* Main action buttons */
    button {
      padding: 0.75rem 1.5rem;
      margin: 5px;
      background-color: #003366;
      color: white;
      border: none;
      border-radius: 0.5rem;
      font-size: 1rem;
      cursor: pointer;
      transition: transform 0.1s ease, background-color 0.2s ease;
    }
    button:hover { background-color: #002244; transform: translateY(-1px); }
    button:active { transform: translateY(0); }

    /* Results styling */
    #results { margin-top: 30px; padding: 15px; border: 1px solid #ccc; background: #fff; }
    #timestamp { margin-top: 10px; font-size: 0.9em; color: #555; }
    .met { color: green; font-weight: bold; }
    .not-met { color: red; font-weight: bold; }
    #backButton { display: none; margin-top: 20px; }

    @media print {
      body { background: white; color: black; font-size: 12px; margin: 20mm; }
      .logo-bar, button, #backButton { display: none !important; }
      header, footer { display: block; text-align: center; font-size: 0.9em; margin: 5px 0; }
    }
    header, footer { display: none; }
  </style>
</head>
<body>
  <header>Confidential – Study Screening Tool</header>
  <div class="logo-bar">
    <img src="images/left_logo.png" alt="Logo 1">
    <img src="images/center_logo.png" alt="Logo 2">
    <img src="images/right_logo.png" alt="Logo 3">
  </div>

  <h1>ReMEDy2 Stroke Trial – Eligibility Checklist</h1>

  <form id="eligibilityForm" name="eligibilityForm">
    <div class="section">
      <h2>Inclusion Criteria</h2>

      <div class="radio-group">
        <label class="question">1. Participant is between 18 and 90 years of age inclusive.</label>
        <label class="choice yes"><input type="radio" name="inclusion1" value="yes"><span>Yes</span></label>
        <label class="choice no"><input type="radio" name="inclusion1" value="no"><span>No</span></label>
      </div>
      <div class="radio-group">
        <label class="question">2. Participant weight is 40 kg to 166 kg inclusive.</label>
        <label class="choice yes"><input type="radio" name="inclusion2" value="yes"><span>Yes</span></label>
        <label class="choice no"><input type="radio" name="inclusion2" value="no"><span>No</span></label>
      </div>
      <div class="radio-group">
        <label class="question">3. Participant is to be randomized and treatment initiated within 24 h of last-known-normal/AIS stroke onset.</label>
        <label class="choice yes"><input type="radio" name="inclusion3" value="yes"><span>Yes</span></label>
        <label class="choice no"><input type="radio" name="inclusion3" value="no"><span>No</span></label>
      </div>
      <div class="radio-group">
        <label class="question">4. NIHSS 5–15 at randomization (including initial &lt; 5 who worsen and meet criteria & repeat imaging).</label>
        <label class="choice yes"><input type="radio" name="inclusion4" value="yes"><span>Yes</span></label>
        <label class="choice no"><input type="radio" name="inclusion4" value="no"><span>No</span></label>
      </div>
      <div class="radio-group">
        <label class="question">5. Pre-morbid mRS 0–1.</label>
        <label class="choice yes"><input type="radio" name="inclusion5" value="yes"><span>Yes</span></label>
        <label class="choice no"><input type="radio" name="inclusion5" value="no"><span>No</span></label>
      </div>
      <div class="radio-group">
        <label class="question">6. If fibrinolytic given within 4.5 h: ≥6 h post-dose, persistent deficit (NIHSS improvement &lt; 4) and repeat imaging criteria met.</label>
        <label class="choice yes"><input type="radio" name="inclusion6" value="yes"><span>Yes</span></label>
        <label class="choice no"><input type="radio" name="inclusion6" value="no"><span>No</span></label>
      </div>
      <div class="radio-group">
        <label class="question">7. Informed consent obtained from participant or LAR.</label>
        <label class="choice yes"><input type="radio" name="inclusion7" value="yes"><span>Yes</span></label>
        <label class="choice no"><input type="radio" name="inclusion7" value="no"><span>No</span></label>
      </div>
      <div class="radio-group">
        <label class="question">8. Participant able and willing to comply with study protocol (per investigator).</label>
        <label class="choice yes"><input type="radio" name="inclusion8" value="yes"><span>Yes</span></label>
        <label class="choice no"><input type="radio" name="inclusion8" value="no"><span>No</span></label>
      </div>
    </div>

    <div class="section">
      <h2>Exclusion Criteria</h2>

      <div class="radio-group">
        <label class="question">1. Imaging-confirmed hemorrhagic stroke at screening or repeat imaging.</label>
        <label class="choice yes"><input type="radio" name="exclusion1" value="yes"><span>Yes</span></label>
        <label class="choice no"><input type="radio" name="exclusion1" value="no"><span>No</span></label>
      </div>
      <div class="radio-group">
        <label class="question">2. Imaging shows symptomatic large vessel occlusion at intracranial carotid (I/T/L), M1 MCA, vertebral or basilar artery.</label>
        <label class="choice yes"><input type="radio" name="exclusion2" value="yes"><span>Yes</span></label>
        <label class="choice no"><input type="radio" name="exclusion2" value="no"><span>No</span></label>
      </div>
      <div class="radio-group">
        <label class="question">3. Large core infarction (ASPECTS 0–5).</label>
        <label class="choice yes"><input type="radio" name="exclusion3" value="yes"><span>Yes</span></label>
        <label class="choice no"><input type="radio" name="exclusion3" value="no"><span>No</span></label>
      </div>
      <div class="radio-group">
        <label class="question">4. Participant has or will receive mechanical thrombectomy (MT) for current AIS.</label>
        <label class="choice yes"><input type="radio" name="exclusion4" value="yes"><span>Yes</span></label>
        <label class="choice no"><input type="radio" name="exclusion4" value="no"><span>No</span></label>
      </div>
      <div class="radio-group">
        <label class="question">5. Suspected or confirmed extracranial arterial dissection.</label>
        <label class="choice yes"><input type="radio" name="exclusion5" value="yes"><span>Yes</span></label>
        <label class="choice no"><input type="radio" name="exclusion5" value="no"><span>No</span></label>
      </div>
      <div class="radio-group">
        <label class="question">6. Ischemic event in brainstem or cerebellum (unless PCA without brainstem involvement).</label>
        <label class="choice yes"><input type="radio" name="exclusion6" value="yes"><span>Yes</span></label>
        <label class="choice no"><input type="radio" name="exclusion6" value="no"><span>No</span></label>
      </div>
      <div class="radio-group">
        <label class="question">7. Recorded SBP < 100 mmHg or MAP < 65 mmHg post-onset & pre-randomization.</label>
        <label class="choice yes"><input type="radio" name="exclusion7" value="yes"><span>Yes</span></label>
        <label class="choice no"><input type="radio" name="exclusion7" value="no"><span>No</span></label>
      </div>
      <div class="radio-group">
        <label class="question">8. On ACE-inhibitor at screening and unwilling to convert to another agent through Day 29 ± 1 day.</label>
        <label class="choice yes"><input type="radio" name="exclusion8" value="yes"><span>Yes</span></label>
        <label class="choice no"><input type="radio" name="exclusion8" value="no"><span>No</span></label>
      </div>
      <div class="radio-group">
        <label class="question">9. Last ACE-inhibitor dose < 24 h prior to study-drug infusion.</label>
        <label class="choice yes"><input type="radio" name="exclusion9" value="yes"><span>Yes</span></label>
        <label class="choice no"><input type="radio" name="exclusion9" value="no"><span>No</span></label>
      </div>
      <div class="radio-group">
        <label class="question">10. History of severe allergic reactions (angioedema/anaphylaxis).</label>
        <label class="choice yes"><input type="radio" name="exclusion10" value="yes"><span>Yes</span></label>
        <label class="choice no"><input type="radio" name="exclusion10" value="no"><span>No</span></label>
      </div>
      <!-- Continue any remaining exclusion items here... -->

    </div>

    <!-- Action Buttons -->
    <button type="button" onclick="checkEligibility()">Check Eligibility</button>
    <button type="button" onclick="printResults()">Print Results</button>
    <button type="button" onclick="downloadPDF()">Download as PDF</button>
  </form>

  <div id="results"></div>
  <div id="timestamp"></div>
  <button id="backButton" onclick="restoreForm()">Back to Form</button>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script>
    function checkEligibility() {
      const form = document.forms["eligibilityForm"];
      let inclusionMet = true, exclusionViolated = false;
      let html = '<h2>Eligibility Result</h2><ul>';

      for (let i=1;i<=8;i++){
        const v = form['inclusion'+i].value;
        html += `<li>Inclusion ${i}: ${v==='yes'?'<span class="met">Met</span>':'<span class="not-met">Not Met</span>'}`;
        if(v!=='yes') inclusionMet=false;
      }
      for (let i=1;i<=10;i++){
        const v = form['exclusion'+i].value;
        html += `<li>Exclusion ${i}: ${v==='no'?'<span class="met">Not Present</span>':'<span class="not-met">Present</span>'}`;
        if(v==='yes') exclusionViolated=true;
      }
      html += '</ul>';
      html += `<h3>${(inclusionMet&&!exclusionViolated)?'<span class="met">Eligible for Study</span>':'<span class="not-met">Not Eligible for Study</span>'}</h3>`;
      document.getElementById("results").innerHTML=html;
      document.getElementById("timestamp").innerText='Results generated on: '+new Date().toLocaleString();
      document.getElementById("backButton").style.display='block';
    }

    function printResults(){ window.print(); }

    async function downloadPDF(){
      const r=document.getElementById('results');
      const ow=r.style.width; r.style.width='800px';
      const canvas=await html2canvas(r,{scale:3}); r.style.width=ow;
      const img=canvas.toDataURL('image/png'),{jsPDF}=window.jspdf;
      const doc=new jsPDF({unit:'pt',format:'letter'});
      const pw=doc.internal.pageSize.getWidth(), ph=doc.internal.pageSize.getHeight();
      const p=doc.getImageProperties(img), ih=(p.height*pw)/p.width;
      doc.addImage(img,'PNG',0,(ph-ih)/2,pw,ih);
      doc.save(`eligibility_${new Date().toISOString().slice(0,10)}.pdf`);
    }

    function restoreForm(){ location.reload(); }
  </script>
</body>
</html>
